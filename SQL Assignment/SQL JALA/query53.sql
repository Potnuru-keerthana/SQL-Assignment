SELECT C.CNAME, C.RATING
FROM CUST C
WHERE C.CNUM IN (
    SELECT O.CNUM
    FROM ORDERS O
    GROUP BY O.CNUM
    HAVING SUM(O.AMT) > (SELECT AVG(AMT) FROM ORDERS)
);
