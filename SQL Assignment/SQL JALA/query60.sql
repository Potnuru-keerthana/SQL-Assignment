SELECT C.CNUM, C.CNAME, C.RATING, C.CITY
FROM CUST C
WHERE C.RATING = (
    SELECT MAX(C2.RATING)
    FROM CUST C2
    WHERE C2.CITY = C.CITY
);
